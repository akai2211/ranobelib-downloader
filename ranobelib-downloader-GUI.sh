#!/bin/bash

VENV_DIR="venv"

echo "=== –°—Ç–∞—Ä—Ç–µ—Ä RanobeLIB Downloader (GUI) ==="

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–∞–ø–∫–∞ venv
if [ ! -d "$VENV_DIR" ]; then
    echo "üîß –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –ù–∞—á–∏–Ω–∞—é –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É..."

    # –°–æ–∑–¥–∞–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
    python3 -m venv $VENV_DIR

    # –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –µ–≥–æ
    source $VENV_DIR/bin/activate

    # –û–±–Ω–æ–≤–ª—è–µ–º pip
    echo "üì¶ –û–±–Ω–æ–≤–ª—è—é pip..."
    pip install --upgrade pip

    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–∞–∑–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
    if [ -f "requirements.txt" ]; then
        echo "üì• –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ requirements.txt..."
        pip install -r requirements.txt
    else
        echo "‚ö†Ô∏è –§–∞–π–ª requirements.txt –Ω–µ –Ω–∞–π–¥–µ–Ω! –ü—Ä–æ–ø—É—Å–∫–∞—é —ç—Ç–æ—Ç —à–∞–≥..."
    fi

    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –¥–ª—è Linux
    echo "üêß –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –ø–∞–∫–µ—Ç—ã Qt –¥–ª—è Linux..."
    pip install PyQt6 PyQt6-WebEngine qtpy

    echo "‚úÖ –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
else
    # –ï—Å–ª–∏ –ø–∞–ø–∫–∞ —É–∂–µ –µ—Å—Ç—å, –ø—Ä–æ—Å—Ç–æ –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –æ–∫—Ä—É–∂–µ–Ω–∏–µ
    echo "üîÑ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–æ. –ê–∫—Ç–∏–≤–∏—Ä—É—é..."
    source $VENV_DIR/bin/activate
fi

# –ó–∞–ø—É—Å–∫–∞–µ–º —Å–∞–º—É –ø—Ä–æ–≥—Ä–∞–º–º—É
echo "üöÄ –ó–∞–ø—É—Å–∫–∞—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ..."
python3 gui.py

# –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –æ–∫—Ä—É–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã
deactivate
